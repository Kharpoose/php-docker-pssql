<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ãƒãƒˆãƒ«çµæœ</title>
    <link rel="stylesheet" href="result.css">
</head>
<body>
    <div class="container">
        <h2>ãƒãƒˆãƒ«çµæœ</h2>
        <div class="result-message" id="resultMessage">ã“ã“ã«å‹æ•—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå…¥ã‚Šã¾ã™</div>

        <div class="pokemon-result">
            <div>
                <h3>ã‚ãªãŸã®ãƒã‚±ãƒ¢ãƒ³</h3>
                <img id="playerImage" src="" alt="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒã‚±ãƒ¢ãƒ³" style="width: 150px; height: auto;">
                <div class="hp-bar"><div class="hp" id="playerHpBar"></div></div>
                <div id="playerHpText"></div>
            </div>
            <div>
                <h3>ç›¸æ‰‹ã®ãƒã‚±ãƒ¢ãƒ³</h3>
                <img id="botImage" src="" alt="æ•µã®ãƒã‚±ãƒ¢ãƒ³" style="width: 150px; height: auto;">
                <div class="hp-bar"><div class="hp" id="opponentHpBar"></div></div>
                <div id="opponentHpText"></div>
            </div>
        </div>

        <button class="button" onclick="location.href='index.html'">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button>
        <button class="button" onclick="location.href='battle.html'">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
    </div>

    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«çµæœã‚’è¡¨ç¤º
        window.onload = function() {
            // sessionStorage ã‚„ localStorage ã«çµæœã‚’ä¿å­˜ã—ã¦ãŠã
            const resultData = JSON.parse(sessionStorage.getItem('battleResult'));

            if (resultData) {
                // çµæœãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                const resultMessage = document.getElementById('resultMessage');
                resultMessage.textContent = resultData.resultMessage;

                const playerHp = resultData.player.hp < 0 ? 0 : resultData.player.hp;
                const botHp = resultData.bot.hp < 0 ? 0 : resultData.bot.hp;

                // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æƒ…å ±
                document.getElementById('playerImage').src = resultData.player.imageUrl;
                document.getElementById('playerHpText').textContent = `HP: ${playerHp}`;
                document.getElementById('playerHpBar').style.width = `${(playerHp / resultData.player.maxHp) * 100}%`;

                // ãƒœãƒƒãƒˆã®æƒ…å ±
                document.getElementById('botImage').src = resultData.bot.imageUrl;
                document.getElementById('opponentHpText').textContent = `HP: ${botHp} `;
                document.getElementById('opponentHpBar').style.width = `${(botHp / resultData.bot.maxHp) * 100}%`;



                if (resultData) {
                    // å‹æ•—ã®æ–‡å­—åˆ—ã¯ä¾‹: "å‹åˆ©!" ã‚„ "è² ã‘!"
                    const resultText = resultData.resultMessage;

                    // ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚»ãƒƒãƒˆ
                    resultMessage.textContent = resultText;

                    // ã‚¯ãƒ©ã‚¹ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰å‹æ•—ã«åˆã‚ã›ã¦ã‚¯ãƒ©ã‚¹ä»˜ä¸
                    resultMessage.classList.remove('win', 'lose');

                    if (resultText.includes("å‹")) {
                        resultMessage.classList.add('win');
                        resultMessage.textContent = "ğŸ‰ ãŠã‚ã§ã¨ã†ï¼å‹åˆ©ã§ã™ï¼ğŸ‰";
                    } else if (resultText.includes("è² ")) {
                        resultMessage.classList.add('lose');
                        resultMessage.textContent = "ğŸ˜¢ æ®‹å¿µã€è² ã‘ã¦ã—ã¾ã„ã¾ã—ãŸ...";
                    }
                }



            }
        }
    </script>
</body>
</html>
